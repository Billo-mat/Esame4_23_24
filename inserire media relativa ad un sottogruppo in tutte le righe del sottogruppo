df['avg_subarea_dist'] = df.groupby('subarea')['avg_dist_same'].transform('mean')
